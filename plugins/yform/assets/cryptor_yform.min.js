var CRYPTOR_YFORM=function(){var k=function(){var a=$("#rex-page-yform-manager-data-edit .page-header h1 small").text().replace(/\[|\]/gi,"");a&&d({cryptor_yform:"field_names",cryptor_yform_value:a},function(a){if(a.length){var b=$("#rex-page-yform-manager-data-edit #rex-yform > form");$.each(a,function(){$('#rex-page-yform-manager-data-edit .table td[data-title="'+this.label+'"]').each(function(){f($(this))});"edit"===b.find('input[name="func"]').val()&&$("#rex-page-yform-manager-data-edit #yform-formular-"+
this.name).each(function(){g($(this))})});h(b)}})},h=function(a){a.on({submit:function(b){b.preventDefault();var c=[],e=$("#rex-page-yform-manager-data-edit .cryptor-yform-element").not(".is-encrypted");e.each(function(){c.push($(this).find(".form-control").val())});c.length||a.off().submit();d({cryptor_yform:"backend_encrypt",cryptor_yform_value:c},function(b){$.each(b,function(a){e.eq(a).find(".form-control").val(this)});a.off().submit()})}})},f=function(a){var b=l(a);if(b.text()){var c=$('<span class="fa cryptor-yform-decrypt-icon"></span>').click(function(c){c.preventDefault();
c={cryptor_yform:a.hasClass("is-encrypted")?"backend_decrypt":"backend_encrypt",cryptor_yform_value:b.attr("title")};d(c,function(c){b.attr("title",c);b.text(c);a.toggleClass("is-encrypted")})});a.addClass("cryptor-yform-element is-encrypted");b.before(c)}},g=function(a){var b=m(a);if(b){var c=$('<span class="fa cryptor-yform-decrypt-icon"></span>').click(function(c){c.preventDefault();c={cryptor_yform:a.hasClass("is-encrypted")?"backend_decrypt":"backend_encrypt",cryptor_yform_value:b.val()};d(c,
function(c){a.toggleClass("is-encrypted");b.val(c)})});a.addClass("cryptor-yform-element is-encrypted");c.appendTo(a.find(".control-label"))}},d=function(a,b){$.ajax({dataType:"json",url:"/redaxo/",method:"POST",data:a,success:function(a){b(a)}})},m=function(a){a=a.find(".form-control");return"text"===a.prop("type")?a:"email"===a.prop("type")?(a.prop("type","text"),a):"textarea"===a.prop("tagName").toLowerCase()?a:null},l=function(a){var b=a.find("span");if(!b.length){var c=a.html();a.wrapInner("<span></span>");
b=a.find("span");b.attr("title",c)}return b.addClass("cryptor-yform-list-value-wrapper")};return{init:function(){k()}}}();$(document).ready(function(){CRYPTOR_YFORM.init()});